<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>ç´™ç®±å…§éƒ¨ä¼°åƒ¹ç³»çµ±</title>
<style>
body { font-family: Arial, sans-serif; padding:20px; max-width:900px; margin:auto; }
input, select { padding:6px; margin:4px 0; width:100%; }
button { padding:10px; margin-top:10px; width:100%; font-size:16px; }
table { border-collapse: collapse; width:100%; margin-top:15px; }
th, td { border:1px solid #ccc; padding:6px; text-align:center; }
.result { background:#f7f7f7; padding:15px; margin-top:15px; }
.highlight { background:#dff0d8; }
</style>
</head>

<body>

<h2>ğŸ“¦ ç´™ç®±å…§éƒ¨ä¼°åƒ¹ç³»çµ±ï¼ˆæœ€çµ‚ç‰ˆï¼‰</h2>

<label>é•· (cm)</label>
<input id="L" type="number">

<label>å¯¬ (cm)</label>
<input id="W" type="number">

<label>é«˜ (cm)</label>
<input id="H" type="number">

<label>æ•¸é‡ (ç®±)</label>
<input id="Q" type="number">

<label>æè³ª</label>
<select id="material">
  <option value="6+4">6+4ï¼ˆä¸‰å±¤ï¼‰</option>
  <option value="6M4">6M4ï¼ˆä¸‰å±¤ï¼‰</option>
  <option value="7M5">7M5ï¼ˆä¸‰å±¤ï¼‰</option>
  <option value="6++M4">6++M4ï¼ˆäº”å±¤ï¼‰</option>
  <option value="7++S6">7++S6ï¼ˆäº”å±¤ï¼‰</option>
  <option value="9++S7">9++S7ï¼ˆäº”å±¤ï¼‰</option>
</select>

<button onclick="calc()">è¨ˆç®—</button>

<div id="output"></div>

<script>
const paperWidths = [297,314,330,347,363,380,396,413,429,446,479,495,528,561,594,627,660,693,726];

const materials = {
  "6+4":  { layer:3, normal:1.15, discount:0.79 },
  "6M4":  { layer:3, normal:1.23, discount:0.87 },
  "7M5":  { layer:3, normal:1.38, discount:1.02 },
  "6++M4":{ layer:5, normal:1.80, discount:1.38 },
  "7++S6":{ layer:5, normal:2.09, discount:1.67 },
  "9++S7":{ layer:5, normal:2.38, discount:1.96 }
};

function cmToFen(cm){
  return Math.ceil(cm / 0.303);
}

function calc(){
  const L = cmToFen(+document.getElementById("L").value);
  const W = cmToFen(+document.getElementById("W").value);
  const H = cmToFen(+document.getElementById("H").value);
  const Q = +document.getElementById("Q").value;
  const key = document.getElementById("material").value;
  const mat = materials[key];

  const paperLen = (L + W) * 2 + 10;
  const needWidth = W + H + (mat.layer === 3 ? 1 : 2);

  let rows = [];
  let best = null;

  for(let p=1;p<=4;p++){
    const need = needWidth * p + 6;
    const use = paperWidths.find(w => w >= need);
    if(!use) continue;
    const waste = use - need;
    const obj = { p, need, use, waste };
    rows.push(obj);
    if(!best || waste < best.waste) best = obj;
  }

  const boxAreaFen = paperLen * needWidth;
  const totalAreaChi = (boxAreaFen * Q) / 10000;
  const price = totalAreaChi > 1000 ? mat.discount : mat.normal;

  const paperCostOne =
    (best.use/100) * (paperLen/100) * price / best.p;

  let html = `
  <div class="result">
  <b>å°åˆ†å°ºå¯¸</b><br>
  é•· ${L}ï½œå¯¬ ${W}ï½œé«˜ ${H}<br><br>

  <b>å±•é–‹ç´™é•·</b>ï¼š${paperLen} å°åˆ†<br>
  <b>å–®ç®±ç´™å¯¬éœ€æ±‚</b>ï¼š${needWidth} å°åˆ†<br><br>

  <b>æ‹šå¯¬è©¦ç®—</b>
  <table>
    <tr><th>æ‹šæ•¸</th><th>å«æè€—éœ€æ±‚</th><th>å®šç´™å¯¬</th><th>æµªè²»</th></tr>`;

  rows.forEach(r=>{
    html += `<tr class="${r===best?'highlight':''}">
      <td>${r.p}</td><td>${r.need}</td><td>${r.use}</td><td>${r.waste}</td>
    </tr>`;
  });

  html += `</table><br>

  <b>æœ€ä½³è§£</b>ï¼š${best.p} æ‹šï¼Œç”¨ ${best.use} å°åˆ†å®šç´™<br><br>

  <b>ç¸½ç”¨é‡</b>ï¼š${totalAreaChi.toFixed(1)} å¹³æ–¹å°å°º<br>
  <b>ä½¿ç”¨åƒ¹æ ¼</b>ï¼š${price} å…ƒ / å¹³æ–¹å°å°º<br><br>

  <b>å–®ç®±ç´™æ¿æˆæœ¬</b>ï¼š<span style="font-size:18px">${paperCostOne.toFixed(2)}</span> å…ƒ
  </div>`;

  document.getElementById("output").innerHTML = html;
}
</script>

</body>
</html>
